重装系统、调整硬盘分区、清理C盘的标准操作流程

# 备份数据

## 找到需要备份的数据

- 由机主搜集的、修改的、创作的文件
  - 机主可识别的文档或者媒体文件，包含
    - 文件数量巨大的，容易重新取得的，排除
    - 程序的中间产物，容易重新取得的，排除
    - 不容易重新取得的，压缩后，包含
  - 可以导入和导出的程序配置文件，包含
    - 浏览器的书签、密码
    - 家目录下的某些 dotfile
  - 已经安装的软件，排除
    - portable 版本的软件，压缩后，包含
  - 公开可得的软件安装源，排除
  - 微信和 QQ 的临时文件
    - 当需要完整的内容时，将 WeChat Files 和 Tencent Files 压缩后，包含
    - 当需要其中一些发送、接受的文件时，在对应文件夹中用 SpaceSniffer 搜索找到，包含

## 把数据复制到其他地方

- 复制，永远不要剪切机主硬盘中的任何文件

### 外置存储

- 将外置存储接入机主的机器，把数据从机主的机器复制到外置存储上
  - 不可以使用 U 盘，IT 侠认证过的可靠型号除外
  - 不可以使用移动机械硬盘，IT 侠或者机主认证过的可靠个体除外
  - 可以使用移动固态硬盘盒+固态硬盘，发热严重的型号，存在掉盘风险的硬盘除外

### 云端

- 在机主的机器中下载云盘的客户端，设置需要同步/上传的文件夹
  - 数据的总量小于 200GB 时，考虑 NJU Box
  - 数据量在 200GB 到 1TB 之间时，考虑 IT 侠活动室的备份服务器
  - 数据量在 1TB 到 5TB 之间时，考虑 NJU ITSC 的 OneDrive for Business
  - 数据量超过 5TB 时，考虑联系 yaoge123
  - 不考虑百度网盘，机主有会员时除外

### 外置存储-其他电脑-云端

- 将机主的硬盘拆下接入硬盘盒，把硬盘盒插入 IT 侠的电脑中，把数据从机主的硬盘复制到 IT 侠的电脑中，再从 IT 侠的电脑上传到云端。
- 仅适用于机主的机器无法正常使用，或者数据需要至少两份拷贝时

# 调整硬盘分区大小/为系统分区腾出空间

## 检查 BitLocker 并备份密钥

- 在管理员终端中输入：`manage-bde -protectors -get <drive letter>:`
  - 其中`<drive letter>`是机主的内置硬盘的分区的卷标，一个大写的英文字母

## 关掉 BitLocker 以调整相关分区的大小

- 不确定是否必要

## 关机，从其他系统启动

- 从装有 Windows PE 的硬盘启动机主的机器
  - 在无法保证 USB 连接可靠时，在机主的机器上安装 DiskGenius，启动到机主系统中的 Windows RE

## 清理 C 盘

- 用 SpaceSniffer 检查 C 盘是否有过大的异常的文件夹
  - Adobe 家的 dump 文件
  - Dell 的意义不明的备份文件
- 除了上述黑名单中的文件夹外，不要删除或者移动任何 C 盘中的文件
  - 不可以使用任何搬家软件
  - 不可以改变`~/Documents`的位置

## 使用 DiskGenius 调整分区的大小

- 有任何问题查找 [DiskGenius 的官方手册](https://www.diskgenius.com/manual/)
- Windows 需要一个至少 128GB 的处于固态硬盘上的系统分区，一个 EFI，和一个 MSR 分区来健康地工作
  - 可以使用 DiskGenius 自动在硬盘上建立 EFI 和 MSR 分区
- 在存在一键恢复系统或者硬盘上安装多个操作系统时，情况变得复杂
  - 不要删掉不认识的分区
  - 无法保证一键恢复系统可以正常工作，在重装系统之后
    - 征求机主意见，考虑删掉一键恢复系统的相关分区
  - 无法保证多重引导可以正常工作，在重装系统之后
    - 重新配置 grub

# 安装系统

## 确认需要安装的系统版本

- 机主的机器自带了 Windows 家庭单语言版：Windows 家庭版
- 机主需要远程桌面的服务端、组策略或者其他高级功能：Windows 专业版、企业版或教育版
- 机主需要名字酷炫的系统：Windows 专业工作站版

## 把系统释放到指定位置

- 有任何问题查找 Dism++ 的使用教程
- 用 Dism++，释放镜像，选择 Windows 的安装镜像，选择版本，选择释放路径，勾选添加引导
- 确认引导文件将被释放到 Windows 的全新安装将被释放到的硬盘上的 EFI 分区中
- 释放完成后，关机，拔掉 U 盘

## 安装驱动

- 开机，等待 Windows 第一次启动
- 起一个只含数字和大小写英文字母的用户名，或者直接使用微软账户登录
- 第一次进入桌面之后，使用 Windows Update 更新驱动
- 对于没有自动安装的驱动
  - 检查 Windows Update 的可选更新
  - 使用 SDIO
    - 只安装缺失的驱动程序，不可以全选，安装。
  - 使用笔记本生产商的支持页面的手动下载功能
    - 永远不要使用笔记本生产商提供的自动下载驱动的程序
- 检查所有硬件的工作状况

## 安装必要的软件

- Office
  - 使用 Office Tool Plus，有任何问题查找[OTP 的官方手册](https://www.coolhub.top/archives/42)
- Adobe 等正版软件
  - 问[ITSC](https://itsc.nju.edu.cn/zbrj/list.htm)